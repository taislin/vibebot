<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM-RAG-Bot Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 flex items-center justify-center h-screen">
    <div class="bg-gray-800 p-6 rounded-lg shadow-lg w-full max-w-2xl flex flex-col h-[80vh]">
        <h1 class="text-2xl font-bold mb-4 text-center text-white">LLM-RAG-Bot Query Interface</h1>
        <div class="flex-1 overflow-y-auto mb-4 p-4 bg-gray-700 rounded-lg" id="chatContainer">
            <!-- Query and response pairs will be appended here -->
        </div>
        <div class="flex flex-col">
            <input
                type="text"
                id="queryInput"
                placeholder="Enter your query (e.g., show me which animal entities are present)"
                class="w-full p-2 mb-2 bg-gray-700 text-white border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
            <button
                onclick="sendQuery()"
                class="w-full bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700"
            >
                Submit Query
            </button>
        </div>
    </div>

    <script>
        async function sendQuery() {
            const query = document.getElementById('queryInput').value.trim();
            if (!query) {
                alert('Please enter a query.');
                return;
            }

            const chatContainer = document.getElementById('chatContainer');
            
            // Append query
            const queryElement = document.createElement('div');
            queryElement.className = 'mb-2 p-2 bg-gray-600 rounded-lg text-white';
            queryElement.textContent = `Query: ${query}`;
            chatContainer.appendChild(queryElement);

            // Append processing message
            const responseElement = document.createElement('div');
            responseElement.className = 'mb-2 p-2 bg-gray-700 rounded-lg text-white';
            responseElement.textContent = 'Processing...';
            chatContainer.appendChild(responseElement);

            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;

            try {
                const response = await fetch('/query', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const data = await response.json();
                const result = data.result || data.error || 'No response received.';
                
                // Update response element
                responseElement.textContent = `Response: ${result}`;
            } catch (error) {
                responseElement.textContent = `Error: ${error.message}`;
            }

            // Scroll to bottom again
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // Clear input
            document.getElementById('queryInput').value = '';
        }
    </script>
</body>
</html>